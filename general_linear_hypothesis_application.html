<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>general_linear_hypothesis_application.utf8</title>

<script src="general_linear_hypothesis_application_files/jquery-3.5.1/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="general_linear_hypothesis_application_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="general_linear_hypothesis_application_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="general_linear_hypothesis_application_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="general_linear_hypothesis_application_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="general_linear_hypothesis_application_files/navigation-1.1/tabsets.js"></script>
<script src="general_linear_hypothesis_application_files/navigation-1.1/codefolding.js"></script>
<link href="general_linear_hypothesis_application_files/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="general_linear_hypothesis_application_files/highlightjs-9.12.0/highlight.js"></script>
<script src="general_linear_hypothesis_application_files/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="general_linear_hypothesis_application_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="general_linear_hypothesis_application_files/datatables-binding-0.17/datatables.js"></script>
<link href="general_linear_hypothesis_application_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="general_linear_hypothesis_application_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="general_linear_hypothesis_application_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<script src="general_linear_hypothesis_application_files/jszip-1.10.20/jszip.min.js"></script>
<script src="general_linear_hypothesis_application_files/pdfmake-1.10.20/pdfmake.js"></script>
<script src="general_linear_hypothesis_application_files/pdfmake-1.10.20/vfs_fonts.js"></script>
<link href="general_linear_hypothesis_application_files/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="general_linear_hypothesis_application_files/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script>
<script src="general_linear_hypothesis_application_files/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script>
<script src="general_linear_hypothesis_application_files/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script>
<script src="general_linear_hypothesis_application_files/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script>
<script src="general_linear_hypothesis_application_files/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script>
<link href="general_linear_hypothesis_application_files/dt-ext-keytable-1.10.20/css/keyTable.dataTables.min.css" rel="stylesheet" />
<script src="general_linear_hypothesis_application_files/dt-ext-keytable-1.10.20/js/dataTables.keyTable.min.js"></script>
<link href="general_linear_hypothesis_application_files/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="general_linear_hypothesis_application_files/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<script src="general_linear_hypothesis_application_files/kePrint-0.0.1/kePrint.js"></script>
<link href="general_linear_hypothesis_application_files/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>




</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>When parameters of a general linear model are estimated, analysts often report the main effects. However, sometimes the hypothesis of interest is a linear combination of the main effects that is not displayed by default in a standard regression table. Testing many hypotheses from the same linear model is especially relevant when an analyst fits a model using categorical variables where many post-hoc hypotheses are of interest. This presentation will show how to code a categorical variable for use in the general linear model and use tests of the so-called general linear hypothesis to test any number of hypotheses about the effects <span class="citation">(Fox <a href="#ref-fox2008applied" role="doc-biblioref">2008</a>)</span>.</p>
<p>This presentation uses the R programming language and assumes the end-user is taking advantage of RStudio IDE to compile their R markdown files into HTML <span class="citation">(R Core Team <a href="#ref-R2020" role="doc-biblioref">2020</a>; RStudio Team <a href="#ref-rstudio2020" role="doc-biblioref">2020</a>)</span>. All of the files needed to reproduce these results can be downloaded from the Git repository <code>git clone <span>https</span>://git.waderstats.com/general_linear_hypothesis_application/</code>.</p>
</div>
<div id="required-libraries" class="section level1">
<h1>Required Libraries</h1>
<p>The libraries <i>knitr</i>, <i>bookdown</i>, and <i>kableExtra</i> are loaded to generate the HTML output <span class="citation">(Xie <a href="#ref-kintr2021" role="doc-biblioref">2021</a>, <a href="#ref-bookdown2020" role="doc-biblioref">2020</a>; Zhu <a href="#ref-kableExtra2020" role="doc-biblioref">2021</a>)</span>. The library <i>magrittr</i> is loaded so we can use the pipe (%&gt;%) operator <span class="citation">(Bache and Wickham <a href="#ref-magrittr2020" role="doc-biblioref">2020</a>)</span>. The library <i>DT</i> is loaded to display simulated data in an output table <span class="citation">(Xie, Cheng, and Tan <a href="#ref-dt2021" role="doc-biblioref">2021</a>)</span>. Data summaries are facilitated by the <i>dplyr</i> library <span class="citation">(Wickham et al. <a href="#ref-dplyr2021" role="doc-biblioref">2021</a>)</span>. The library <i>multcomp</i> is loaded so we can do tests of the general linear hypothesis <span class="citation">(Hothorn, Bretz, and Westfall <a href="#ref-multcomp2008" role="doc-biblioref">2008</a>; Fox <a href="#ref-fox2008applied" role="doc-biblioref">2008</a>)</span>.</p>
<pre class="r"><code>package_loader &lt;- function(x, ...) {
  if (x %in% rownames(installed.packages()) == FALSE) install.packages(x)
  library(x, ...)
}

packages &lt;- c(&quot;knitr&quot;, &quot;bookdown&quot;, &quot;kableExtra&quot;, &quot;magrittr&quot;, &quot;DT&quot;, &quot;dplyr&quot;, &quot;multcomp&quot;)

invisible(sapply(X = packages, FUN = package_loader, character.only = TRUE))</code></pre>
</div>
<div id="data-generating-process" class="section level1">
<h1>Data Generating Process</h1>
<p>Suppose we have a set of <span class="math inline">\(i \in \{1, ... , n\}\)</span> independent and identically distributed normal random variables each denoted by <span class="math inline">\(y_i\)</span>, whose value depends on a categorical variable with three levels, <span class="math inline">\(x \in \{l, m, h\}\)</span> that correspond to <i>low</i>, <i>medium</i>, and <i>high</i>, respectively. We will further assume that <span class="math inline">\(E[y_i|x] = \mu_x\)</span> with constant variance <span class="math inline">\(\sigma^2\)</span>. The data generating process is written concisely in equation <a href="#eq:dgp">(1)</a>.</p>
<p><span class="math display" id="eq:dgp">\[\begin{equation}
\begin{split}
y_i|x \sim N(\mu_{x}, \sigma^2)
\end{split}
\tag{1}
\end{equation}\]</span></p>
</div>
<div id="simulation-data" class="section level1">
<h1>Simulation Data</h1>
<p>Simulating data using this data generating process is straight forward. We will assume <span class="math inline">\(\mu_{x = l} = 1\)</span>, <span class="math inline">\(\mu_{x = m} = 1\)</span>, <span class="math inline">\(\mu_{x = h} = 2\)</span> with fixed variance <span class="math inline">\(\sigma^2 = 1\)</span> and generate a single realization for each of <span class="math inline">\(n = 100\)</span> normal random variables.</p>
<pre class="r"><code>set.seed(123)

# Create an empty data frame to hold the simulated data.
d &lt;- matrix(nrow = 100, ncol = 2)
colnames(d) &lt;- c(&quot;Y&quot;, &quot;X&quot;)
d &lt;- as.data.frame(d)

# We assume without loss of generality that each of the categories is equally likely to be observed.
X &lt;- sample(x = c(&quot;l&quot;, &quot;m&quot;, &quot;h&quot;), size = 100, replace = TRUE, prob = c(1/3, 1/3, 1/3))
d$X &lt;- X

# Since the distribution of each y_i depends on the value of x, we generate the outcome separately for each possible value.
d[which(d$X == &quot;l&quot;), &quot;Y&quot;] &lt;- rnorm(n = length(which(d$X == &quot;l&quot;)), mean = 1, sd = 1)
d[which(d$X == &quot;m&quot;), &quot;Y&quot;] &lt;- rnorm(n = length(which(d$X == &quot;m&quot;)), mean = 1, sd = 1)
d[which(d$X == &quot;h&quot;), &quot;Y&quot;] &lt;- rnorm(n = length(which(d$X == &quot;h&quot;)), mean = 2, sd = 1)

# The factor function tells R that X is a factor and should be treated as such in downstream analyses.
d$X &lt;- factor(d$X, levels = c(&quot;l&quot;, &quot;m&quot;, &quot;h&quot;))

# We can use the datatable function to display the simulated data.
datatable(d, escape = FALSE, 
          caption = &quot;This table contains the simulated data from the data generating process.  Each value in the Y column is a realization of an independent and identically distributed normal random variable whose expectation is conditional on the value in the X column.&quot;,
          extensions = c(&#39;Buttons&#39;, &#39;KeyTable&#39;),
          class = &#39;cell-border stripe&#39;,
          rownames = TRUE,
          options = list(
            dom = &#39;Bfrtip&#39;,
            pageLength = 10,
            deferRender = TRUE,
            responsive = TRUE,
            scrollX = TRUE,
            scrollCollaspe = TRUE,
            paging = TRUE,
            autoWidth = FALSE,
            keys = TRUE,
            buttons = c(&#39;copy&#39;, &#39;csv&#39;, &#39;excel&#39;, &#39;pdf&#39;, &#39;print&#39;)
          ))</code></pre>
<div id="htmlwidget-d96970b9501c191ad406" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d96970b9501c191ad406">{"x":{"filter":"none","extensions":["Buttons","KeyTable"],"caption":"<caption>This table contains the simulated data from the data generating process.  Each value in the Y column is a realization of an independent and identically distributed normal random variable whose expectation is conditional on the value in the X column.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],[1.64437654851883,1.25331851399475,2.10567619414894,0.971453244651297,0.957129542708684,0.779513438181249,1.35929399169462,2.36860228401446,1.15029565396642,0.975871209395087,0.774229014340732,2.11764659710013,2.51647060442954,1.0525253858152,1.3317819639157,-0.548752804230221,2.09683901314935,1.4351814908338,0.674068414468773,1.58461374963607,1.12385424384461,1.21594156874397,1.50944255629933,1.37963948275988,1.74390780780175,0.497676546890698,3.84386200523221,1.34805009830454,2.14880761845109,1.99350385596212,0.66679261633058,-0.0185753831070887,-0.0717912264755778,1.30352864140426,1.54839695950807,2.23538657228486,1.44820977862943,1.23873173511144,0.372093923960629,2.36065244853001,0.399740412852873,2.07796084956371,1.03814336586987,1.9286919138764,3.18733299301658,2.53261062618519,0.764299640899523,3.44455085842335,-0.0264209003067808,1.0530042267305,0.289593436300699,2.45150405307921,1.92226746787974,1.25688370915653,2.04123292199294,0.753308121537626,0.652457400602267,3.05008468562714,0.508968833943465,1.57750316766038,-0.0532472215405155,0.0483814327349843,3.13133721341418,0.95497227519108,-1.30916887564081,0.539359929075178,2.00573852446226,0.290799237417607,0.311991383532642,2.73994751087733,2.0255713696967,3.90910356921748,0.715226992948991,0.215095530542924,0.556106839028201,-0.667941936588137,2.70178433537471,1.73780251059753,0.427855840854512,0.619773479712238,1.91899660906077,-0.220717712254536,0.485332346218249,1.18130347974915,0.424653037391608,0.398463826425407,0.861108637560955,1.00576418589989,1.38528040112633,1.60796432222503,-0.617882708289164,1.4690934778297,0.5382444150041,2.68791677297583,0.944438034475461,1.51940720394346,0.629339968207591,1.30115336216671,4.10010894052567,0.712969523964821],["m","l","h","l","l","m","h","l","h","h","l","h","l","h","m","l","m","m","m","l","l","l","h","l","h","l","h","h","m","m","l","l","l","l","m","h","l","m","m","m","m","h","h","h","m","m","m","h","m","l","m","h","l","m","h","m","m","l","l","h","h","m","h","m","l","h","l","l","l","h","l","h","l","m","h","m","h","h","h","m","m","l","h","l","m","h","l","l","l","m","m","h","h","h","m","m","l","m","h","h"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Y<\/th>\n      <th>X<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","pageLength":10,"deferRender":true,"responsive":true,"scrollX":true,"scrollCollaspe":true,"paging":true,"autoWidth":false,"keys":true,"buttons":["copy","csv","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":1},{"orderable":false,"targets":0}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Table <a href="#tab:simulatedTabSummaries">1</a> shows the estimated mean and variance for the outcome for each level of the categorical variable in the simulated data set.</p>
<pre class="r"><code>dSumarries &lt;- d %&gt;% 
  group_by(X) %&gt;%
  summarize(
    mean = round(mean(Y, na.rm = TRUE), 2),
    variance = round(sd(Y, na.rm = TRUE)^2, 2)
  )

dSumarries %&gt;%
  kbl(escape = FALSE, caption = &quot;The estimated mean and variance of the outcome for each value of the categorical variable in the simulated data.&quot;) %&gt;%
  kable_classic_2(full_width = F)</code></pre>
<table class=" lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
<span id="tab:simulatedTabSummaries">Table 1: </span>The estimated mean and variance of the outcome for each value of the categorical variable in the simulated data.
</caption>
<thead>
<tr>
<th style="text-align:left;">
X
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
variance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
l
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.80
</td>
</tr>
<tr>
<td style="text-align:left;">
m
</td>
<td style="text-align:right;">
1.08
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
h
</td>
<td style="text-align:right;">
1.77
</td>
<td style="text-align:right;">
1.20
</td>
</tr>
</tbody>
</table>
</div>
<div id="dummy-coding-the-categorical-predictor" class="section level1">
<h1>Dummy Coding the Categorical Predictor</h1>
<p>We can write <span class="math inline">\(E[y|x] = \mu_x\)</span> as a linear combination of a constant and <span class="math inline">\(x\)</span> by dummy coding <span class="math inline">\(x\)</span>. Dummy coding transforms <span class="math inline">\(x\)</span> into a set of dichotomous predictors for all but one of the levels which we call the reference category. In the current example, dummy coding says that <span class="math inline">\(x_{l} = 1\)</span> if in the <i>low</i> category and <span class="math inline">\(x_{l} = 0\)</span> otherwise; <span class="math inline">\(x_{m} = 1\)</span> if in the <i>medium</i> category and <span class="math inline">\(x_{m} = 0\)</span> otherwise; <span class="math inline">\(x_{h} = 1\)</span> if in the <i>high</i> category and <span class="math inline">\(x_{h} = 0\)</span> otherwise.</p>
<p>If we treat <span class="math inline">\(x_l\)</span> as the referent category, the expectation of <span class="math inline">\(y\)</span> can be written as a linear function of the categorical predictor (equation <a href="#eq:linPred">(2)</a>).</p>
<p><span class="math display" id="eq:linPred">\[\begin{equation}
\begin{split}
E[y|x] = \alpha + \beta_1 x_{m} + \beta_2 x_{h}
\end{split}
\tag{2}
\end{equation}\]</span></p>
<p>For the simulated data, the design matrix for the dummy coded categorical variable is shown below.</p>
<pre class="r"><code># The model.matrix function extracts the design matrix for a given formula object.
dDM &lt;- model.matrix(as.formula(Y ~ X), data = d)

# We can use the datatable function to display the design matrix for the simulated data.
datatable(dDM, escape = FALSE, 
          caption = &quot;The design matrix for the simulated data that shows the dummy coding for the categorical variable.&quot;,
          extensions = c(&#39;Buttons&#39;, &#39;KeyTable&#39;),
          class = &#39;cell-border stripe&#39;,
          rownames = TRUE,
          options = list(
            dom = &#39;Bfrtip&#39;,
            pageLength = 10,
            deferRender = TRUE,
            responsive = TRUE,
            scrollX = TRUE,
            scrollCollaspe = TRUE,
            paging = TRUE,
            autoWidth = FALSE,
            keys = TRUE,
            buttons = c(&#39;copy&#39;, &#39;csv&#39;, &#39;excel&#39;, &#39;pdf&#39;, &#39;print&#39;)
          ))</code></pre>
<div id="htmlwidget-bbf49928d385f1dd9e5c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-bbf49928d385f1dd9e5c">{"x":{"filter":"none","extensions":["Buttons","KeyTable"],"caption":"<caption>The design matrix for the simulated data that shows the dummy coding for the categorical variable.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,1,1,1,0,0,0,1,1,1,0,1,0,1,0,0,1,0,1,1,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,1,0,0,0,1,0,0,0,0,1,1,0,0,0,1,1,0,1,0,0],[0,0,1,0,0,0,1,0,1,1,0,1,0,1,0,0,0,0,0,0,0,0,1,0,1,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,1,1,0,1,0,0,1,0,0,0,1,0,1,0,0,1,0,1,1,1,0,0,0,1,0,0,1,0,0,0,0,0,1,1,1,0,0,0,0,1,1]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>(Intercept)<\/th>\n      <th>Xm<\/th>\n      <th>Xh<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","pageLength":10,"deferRender":true,"responsive":true,"scrollX":true,"scrollCollaspe":true,"paging":true,"autoWidth":false,"keys":true,"buttons":["copy","csv","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="tests-of-the-general-linear-hypothesis" class="section level1">
<h1>Tests of the General Linear Hypothesis</h1>
<div id="a-simple-example" class="section level2">
<h2>A Simple Example</h2>
<p>Under the dummy coding scheme, the mean of <span class="math inline">\(y\)</span> for each level of the categorical variable can be derived from the linear predictor.</p>
<ul>
<li>The mean value of <span class="math inline">\(y\)</span> when the categorical variable is <i>low</i> is <span class="math inline">\(\mu_{x=l} = E[y|x_m = 0, x_h = 0] = \alpha\)</span>.</li>
<li>The mean value of <span class="math inline">\(y\)</span> when the categorical variable is <i>medium</i> is <span class="math inline">\(\mu_{x=m} = E[y|x_m = 1, x_h = 0] = \alpha + \beta_1\)</span>.</li>
<li>The mean value of <span class="math inline">\(y\)</span> when the categorical variable is <i>high</i> is <span class="math inline">\(\mu_{x=h} = E[y|x_m = 0, x_h = 0] = \alpha + \beta_2\)</span>.</li>
</ul>
<p>The first step in deriving these effects for the current data is to fit a linear model to the data and extract the parameter estimates for the main effects.</p>
<pre class="r"><code># Estimate the parameters for the linear model
fit &lt;- lm(Y~X, data = d)
fit</code></pre>
<pre><code>## 
## Call:
## lm(formula = Y ~ X, data = d)
## 
## Coefficients:
## (Intercept)           Xm           Xh  
##     0.99512      0.08678      0.77205</code></pre>
<p>Next, we create a matrix containing a single row for each linear effect we care about. The linear effect matrix is multiplied by the vector of estimated coefficients for the main effects to get the effects of interest.</p>
<pre class="r"><code># Matrix that represents each linear effect we want to estimate.
mMat &lt;- rbind(c(1, 0, 0), c(1, 1, 0), c(1, 0, 1))
mMat</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    1    1    0
## [3,]    1    0    1</code></pre>
<pre class="r"><code># Vector of estiamted coefficients from the linear model
cMat &lt;- matrix(coef(fit), nrow = 3)
cMat</code></pre>
<pre><code>##            [,1]
## [1,] 0.99511828
## [2,] 0.08678364
## [3,] 0.77205010</code></pre>
<pre class="r"><code># The estimated value of y for each value of the category.
mMat %*% cMat</code></pre>
<pre><code>##           [,1]
## [1,] 0.9951183
## [2,] 1.0819019
## [3,] 1.7671684</code></pre>
<p>To test the null hypothesis that any of these estimated effects are zero, we can apply the general linear hypothesis <span class="citation">(Fox <a href="#ref-fox2008applied" role="doc-biblioref">2008</a>)</span>.</p>
<ul>
<li><span class="math inline">\(H_0: \alpha = 0\)</span> tests the null hypothesis that the mean value of <span class="math inline">\(y\)</span> is zero when the categorical variable is <i>low</i> (<span class="math inline">\(x = l\)</span>).</li>
<li><span class="math inline">\(H_0: \alpha + \beta_1 = 0\)</span> tests the null hypothesis that the mean value of <span class="math inline">\(y\)</span> is zero when the categorical variable is <i>medium</i> (<span class="math inline">\(x = m\)</span>).</li>
<li><span class="math inline">\(H_0: \alpha + \beta_2 = 0\)</span> tests the null hypothesis that the mean value of <span class="math inline">\(y\)</span> is zero when the categorical variable is <i>high</i> (<span class="math inline">\(x = h\)</span>).</li>
</ul>
<pre class="r"><code>mTest &lt;- glht(model = fit, linfct = mMat)
summary(mTest)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Fit: lm(formula = Y ~ X, data = d)
## 
## Linear Hypotheses:
##        Estimate Std. Error t value Pr(&gt;|t|)    
## 1 == 0   0.9951     0.1680   5.923 1.35e-07 ***
## 2 == 0   1.0819     0.1680   6.439  &lt; 1e-07 ***
## 3 == 0   1.7672     0.1655  10.676  &lt; 1e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
</div>
<div id="a-more-complicated-example" class="section level2">
<h2>A More Complicated Example</h2>
<p>Specifying linear hypotheses allows us to test any number of effects inferentially.</p>
<ul>
<li><span class="math inline">\(H_0: \mu_{x=l} - \mu_{x = h} = \alpha - (\alpha + \beta_2) = -\beta_2 = 0\)</span> tests the null hypothesis that the mean value of <span class="math inline">\(y\)</span> in the referent category <i>low</i> (<span class="math inline">\(x = l\)</span>) is the same as the mean value of <span class="math inline">\(y\)</span> in the <i>high</i> category (<span class="math inline">\(x = h\)</span>).</li>
</ul>
<p>We can get even more fancy and derive the mean value of <span class="math inline">\(y\)</span> that is marginalized over the <i>medium</i> and <i>high</i> categories.</p>
<ul>
<li><span class="math inline">\(H_0: \mu_{x=l} - \frac{(\mu_{x=m} + \mu_{x = h})}{2} = \alpha - \frac{\alpha + \beta_1 + \alpha + \beta_2}{2} = \alpha - \frac{1}{2}\beta_1 - \frac{1}{2}\beta_2 = 0\)</span> tests the null hypothesis that the mean value of <span class="math inline">\(y\)</span> in the referent category <i>low</i> (<span class="math inline">\(x = l\)</span>) is the same as the mean value of <span class="math inline">\(y\)</span> with in either the <i>medium</i> or <i>high</i> categories (<span class="math inline">\(x = m\)</span> or <span class="math inline">\(x =l\)</span>).</li>
</ul>
<pre class="r"><code>oMat &lt;- rbind(c(0, 0, -1), c(1, -1/2, -1/2))
oMat</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,]    0  0.0 -1.0
## [2,]    1 -0.5 -0.5</code></pre>
<pre class="r"><code>oTest &lt;- glht(model = fit, linfct = oMat)
summary(oTest)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Fit: lm(formula = Y ~ X, data = d)
## 
## Linear Hypotheses:
##        Estimate Std. Error t value Pr(&gt;|t|)   
## 1 == 0  -0.7721     0.2359  -3.273  0.00248 **
## 2 == 0   0.5657     0.3561   1.588  0.16690   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
<div id="multiple-comparisons" class="section level1">
<h1>Multiple Comparisons</h1>
<p>Unless the goal is to publish in the Journal of Irreproducible Results, an analyst should adjust for simultaneously testing multiple hypotheses.</p>
<p>The multiple testing problem occurs because our fixed and known probability of falsely rejecting a true null hypothesis (usually <span class="math inline">\(5\%\)</span>) applies only to a single test and increases as a function of the total number of inferences. For example, suppose we do 20 simultaneous tests, each with a <span class="math inline">\(5\%\)</span> probability of being a false discovery. In that case, we expect at least one of these inferences will result in falsely rejecting a true null hypothesis.</p>
<p>There are two commonly used methods for adjusting for multiple comparisons. The first controls for the probability of falsely rejecting at least one true null hypothesis among all hypotheses tested, also known as the family-wise error rate (FWER), and typified by the Bonferroni correction <span class="citation">(Dunn <a href="#ref-dunn1961multiple" role="doc-biblioref">1961</a>)</span>. The second controls the probability of falsely rejecting at least one true null hypothesis among rejected hypotheses, known as the false discovery rate (FDR) <span class="citation">(Benjamini and Hochberg <a href="#ref-benjamini1995controlling" role="doc-biblioref">1995</a>)</span>.</p>
<p>Table <a href="#tab:resTab">2</a> shows the inferential results after adjusting for both the FWER and FDR.</p>
<pre class="r"><code>resTab &lt;- rbind(cbind(summary(mTest)$test$coefficients, summary(mTest)$test$sigma, summary(mTest)$test$tstat, summary(mTest)$test$pvalues),
                cbind(summary(oTest)$test$coefficients, summary(oTest)$test$sigma, summary(oTest)$test$tstat, summary(oTest)$test$pvalues)
)

rownames(resTab) &lt;- c(&quot;$H_0: \\mu_{x = l} = 0$&quot;, &quot;$H_0: \\mu_{x = m} = 0$&quot;, &quot;$H_0: \\mu_{x = h} = 0$&quot;, &quot;$H_0: \\mu_{x = l} - \\mu_{x = h} = 0$&quot;, &quot;$H_0: \\mu_{x = l} - \\frac{1}{2}(\\mu_{x = m} + \\mu_{x = h}) = 0$&quot;)

resTab &lt;- cbind(resTab, p.adjust(resTab[, 4], method = &quot;bonferroni&quot;), p.adjust(resTab[, 4], method = &quot;fdr&quot;))

colnames(resTab) &lt;- c(&quot;Estimate&quot;, &quot;Std. Error&quot;, &quot;t value&quot;, &quot;Pr(&gt;|t|)&quot;, &quot;FWER Pr(&gt;|t|)&quot;, &quot;FDR Pr(&gt;|t|)&quot;)

resTab %&gt;%
  kbl(escape = FALSE, caption = &quot;The results for all analyses with inferential results controlling the family-wise error rate (FWER) and false discovery rate (FDR).&quot;) %&gt;%
  kable_classic_2(full_width = F)</code></pre>
<table class=" lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
<span id="tab:resTab">Table 2: </span>The results for all analyses with inferential results controlling the family-wise error rate (FWER) and false discovery rate (FDR).
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
t value
</th>
<th style="text-align:right;">
Pr(&gt;|t|)
</th>
<th style="text-align:right;">
FWER Pr(&gt;|t|)
</th>
<th style="text-align:right;">
FDR Pr(&gt;|t|)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(H_0: \mu_{x = l} = 0\)</span>
</td>
<td style="text-align:right;">
0.9951183
</td>
<td style="text-align:right;">
0.1680157
</td>
<td style="text-align:right;">
5.922769
</td>
<td style="text-align:right;">
0.0000002
</td>
<td style="text-align:right;">
0.0000008
</td>
<td style="text-align:right;">
0.0000003
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(H_0: \mu_{x = m} = 0\)</span>
</td>
<td style="text-align:right;">
1.0819019
</td>
<td style="text-align:right;">
0.1680157
</td>
<td style="text-align:right;">
6.439290
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000001
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(H_0: \mu_{x = h} = 0\)</span>
</td>
<td style="text-align:right;">
1.7671684
</td>
<td style="text-align:right;">
0.1655265
</td>
<td style="text-align:right;">
10.676048
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(H_0: \mu_{x = l} - \mu_{x = h} = 0\)</span>
</td>
<td style="text-align:right;">
-0.7720501
</td>
<td style="text-align:right;">
0.2358565
</td>
<td style="text-align:right;">
-3.273389
</td>
<td style="text-align:right;">
0.0024808
</td>
<td style="text-align:right;">
0.0124040
</td>
<td style="text-align:right;">
0.0031010
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(H_0: \mu_{x = l} - \frac{1}{2}(\mu_{x = m} + \mu_{x = h}) = 0\)</span>
</td>
<td style="text-align:right;">
0.5657014
</td>
<td style="text-align:right;">
0.3561239
</td>
<td style="text-align:right;">
1.588496
</td>
<td style="text-align:right;">
0.1669037
</td>
<td style="text-align:right;">
0.8345186
</td>
<td style="text-align:right;">
0.1669037
</td>
</tr>
</tbody>
</table>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<!-- This is needed to resize iframe content. Please ignore if duplicationg this R markdown file -->
<script type="text/javascript" src="https://www.waderstats.com/wp-includes/js/iframe-resizer/js/iframeResizer.contentWindow.min.js" defer></script>
<div id="refs" class="references">
<div id="ref-magrittr2020">
<p>Bache, Stefan Milton, and Hadley Wickham. 2020. <a href="https://CRAN.R-project.org/package=magrittr">https://CRAN.R-project.org/package=magrittr</a>.</p>
</div>
<div id="ref-benjamini1995controlling">
<p>Benjamini, Yoav, and Yosef Hochberg. 1995. “Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing.” <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 57 (1): 289–300.</p>
</div>
<div id="ref-dunn1961multiple">
<p>Dunn, Olive Jean. 1961. “Multiple Comparisons Among Means.” <em>Journal of the American Statistical Association</em> 56 (293): 52–64.</p>
</div>
<div id="ref-fox2008applied">
<p>Fox, John. 2008. <em>Applied Regression Analysis and Generalized Linear Models</em>. Sage Publications.</p>
</div>
<div id="ref-multcomp2008">
<p>Hothorn, Torsten, Frank Bretz, and Peter Westfall. 2008. “Simultaneous Inference in General Parametric Models.” <em>Biometrical Journal</em> 50 (3): 346–63.</p>
</div>
<div id="ref-R2020">
<p>R Core Team. 2020. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.</p>
</div>
<div id="ref-rstudio2020">
<p>RStudio Team. 2020. <em>RStudio: Integrated Development Environment for R</em>. Boston, MA: RStudio, PBC. <a href="http://www.rstudio.com/">http://www.rstudio.com/</a>.</p>
</div>
<div id="ref-dplyr2021">
<p>Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2021. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.</p>
</div>
<div id="ref-bookdown2020">
<p>Xie, Yihui. 2020. <em>Bookdown: Authoring Books and Technical Documents with R Markdown</em>. <a href="https://github.com/rstudio/bookdown">https://github.com/rstudio/bookdown</a>.</p>
</div>
<div id="ref-kintr2021">
<p>———. 2021. <em>Knitr: A General-Purpose Package for Dynamic Report Generation in R</em>. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.</p>
</div>
<div id="ref-dt2021">
<p>Xie, Yihui, Joe Cheng, and Xianying Tan. 2021. <em>DT: A Wrapper of the Javascript Library ’Datatables’</em>. <a href="https://CRAN.R-project.org/package=DT">https://CRAN.R-project.org/package=DT</a>.</p>
</div>
<div id="ref-kableExtra2020">
<p>Zhu, Hao. 2021. <em>KableExtra: Construct Complex Table with ’Kable’ and Pipe Syntax</em>. <a href="https://CRAN.R-project.org/package=kableExtra">https://CRAN.R-project.org/package=kableExtra</a>.</p>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "general_linear_hypothesis_application_files/mathjax-local/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
